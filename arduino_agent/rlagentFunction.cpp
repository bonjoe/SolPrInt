#include "rlagentFunction.h"


double fc1_weights[32*7] = {
    -1.58831194043159485e-01, 2.13883966207504272e-01, 5.37309795618057251e-02, -7.49296769499778748e-02, -9.69337046146392822e-01, 1.51658400893211365e-01, 3.46589207649230957e-01, 
    3.39370518922805786e-02, 4.35221828520298004e-02, -4.92342561483383179e-02, 8.88345204293727875e-03, -2.17707715928554535e-02, 1.04295108467340469e-02, 3.00877951085567474e-02, 
    -1.19424732401967049e-02, -4.47311736643314362e-02, -4.79279160499572754e-02, 7.61058628559112549e-02, -5.45774281024932861e-01, 2.88348849862813950e-02, -1.76138028502464294e-01, 
    -3.75252842903137207e-01, -2.60538101196289062e-01, 6.35006874799728394e-02, 1.58182471990585327e-01, -7.44453668594360352e-02, -3.13368827104568481e-01, 2.05252513289451599e-01, 
    1.24038785696029663e-01, -1.87972560524940491e-02, 2.68804132938385010e-01, -1.45415335893630981e-01, -2.58442521095275879e-01, 2.06750661134719849e-01, -2.35664635896682739e-01, 
    -2.59749013930559158e-02, -5.47159276902675629e-02, 1.00043438374996185e-01, -7.76891261339187622e-02, -1.67165383696556091e-01, -1.23591460287570953e-01, -3.58662791550159454e-02, 
    -6.96643516421318054e-02, -5.99776864051818848e-01, -4.11522574722766876e-02, -5.60867041349411011e-02, 4.93945270776748657e-01, 3.72147113084793091e-02, -3.57498407363891602e-01, 
    7.83895075321197510e-01, 1.84375777840614319e-01, -3.80068235099315643e-02, 1.12100370228290558e-01, -9.93940830230712891e-01, 1.26630499958992004e-01, 1.63795351982116699e-01, 
    -1.06090863027930027e-06, -6.14087014128017472e-07, 5.83125274158442135e-17, -2.22703814506530762e-03, -2.89493385935202241e-04, -3.80114559084177017e-03, -8.68318311404436827e-05, 
    3.52156519889831543e-01, 1.43144160509109497e-01, -7.37266317009925842e-02, -2.55713444203138351e-02, -1.51361018419265747e-01, 1.34973004460334778e-01, -2.71390616893768311e-01, 
    -1.86789870262145996e-01, -4.92466002702713013e-01, 7.32614696025848389e-02, -7.33603537082672119e-02, -2.90682435035705566e-01, 8.85127708315849304e-02, 4.07487660646438599e-01, 
    -2.68580661213491112e-05, -7.14057250661426224e-07, -2.75771273300051689e-03, -3.02891340106725693e-03, -9.84953017905354500e-04, -2.94836470857262611e-03, -1.88836889986163277e-15, 
    -8.66674184799194336e-01, -2.24961861968040466e-01, -3.39876949787139893e-01, 2.30830803513526917e-01, 5.48307538032531738e-01, 1.27975940704345703e-01, -2.30697631835937500e-01, 
    3.99769961833953857e-01, -2.79530491679906845e-02, 4.50446605682373047e-02, -3.32039266824722290e-01, 3.48305821418762207e-01, -4.79881465435028076e-02, 9.31095182895660400e-02, 
    -6.05053365230560303e-01, -8.37882161140441895e-02, -1.04718916118144989e-01, -1.07344853878021240e+00, 2.79833465814590454e-01, 8.57402458786964417e-02, -2.16795410960912704e-02, 
    -1.88052237033843994e-01, 4.85472492873668671e-02, -3.68600159883499146e-01, 4.18676435947418213e-01, -9.90647152066230774e-02, -2.02265903353691101e-02, 4.90986734628677368e-01, 
    -3.49846154451370239e-01, -5.55895626544952393e-01, -4.84667345881462097e-02, 1.94798320531845093e-01, 5.29865980148315430e-01, 7.19568952918052673e-02, -3.49328309297561646e-01, 
    -1.15599371492862701e-01, 2.11227461695671082e-01, -5.24287782609462738e-02, -1.75560981035232544e-01, 5.40473282337188721e-01, -1.90983284264802933e-02, -9.50102880597114563e-02, 
    6.18088483810424805e-01, 4.38027025666087866e-04, -1.32914707064628601e-01, 1.75769463181495667e-01, 2.07836031913757324e-01, 1.28973588347434998e-01, 5.01220643520355225e-01, 
    3.44481736421585083e-01, 2.57947266101837158e-01, -1.33793219923973083e-01, 6.64109662175178528e-02, 6.93603873252868652e-01, 2.48709663748741150e-01, -4.85546067357063293e-02, 
    8.09693261981010437e-02, -2.66773730516433716e-01, 4.78497534990310669e-01, -1.78957179188728333e-01, -5.34081757068634033e-01, -2.84126102924346924e-01, -7.58571922779083252e-02, 
    -1.20482289791107178e+00, -3.61644923686981201e-01, 5.50414435565471649e-02, 2.70557284355163574e-01, -2.23643228411674500e-01, -1.16765215992927551e-01, -4.08360362052917480e-01, 
    4.67902421951293945e-02, 6.32268562912940979e-02, -6.97071924805641174e-02, 1.14389285445213318e-01, -3.25340032577514648e-03, -2.12125688791275024e-01, 1.63064766675233841e-02, 
    3.50916245952248573e-03, -2.95617873780429363e-03, -7.85517599433660507e-03, -7.09181651473045349e-03, -1.27624406013637781e-03, 8.64189234562218189e-04, 4.95838792994618416e-03, 
    -6.76144659519195557e-01, 1.31532892584800720e-01, -8.68543535470962524e-02, 2.20495879650115967e-01, -8.97982478141784668e-01, 2.01411500573158264e-01, -2.72913187742233276e-01, 
    -3.22458177804946899e-01, -1.43530502915382385e-01, 1.52387479320168495e-02, -6.24886937439441681e-02, 3.88323634862899780e-01, -3.36478697136044502e-03, 1.40325158834457397e-01, 
    5.25752663612365723e-01, 1.52991682291030884e-01, 7.21359252929687500e-02, 3.35722253657877445e-03, -3.26250731945037842e-01, -8.93106777220964432e-03, -2.81444013118743896e-01, 
    3.88026416301727295e-01, -1.60076111555099487e-01, -3.85453589260578156e-02, -7.91536644101142883e-03, -5.38296520709991455e-01, 8.02871957421302795e-02, 2.63922691345214844e-01, 
    -2.09195585921406746e-03, -3.49097303114831448e-04, -3.58108570799231529e-03, -2.56482791155576706e-03, -3.13574844039976597e-03, -4.62394393980503082e-03, -3.15815652720630169e-03, 
    -1.02097086608409882e-01, -7.42447748780250549e-02, -1.61697771400213242e-02, -4.96441364288330078e-01, -4.28975135087966919e-01, 7.99991264939308167e-02, 2.30408713221549988e-01, 
    -5.55589735507965088e-01, -1.39284342527389526e-01, 1.01499464362859726e-02, 5.10423220694065094e-02, -2.59009748697280884e-01, 1.81734308600425720e-01, -6.96556806564331055e-01, 
    -2.18644753098487854e-01, 1.71010375022888184e-01, 4.32506985962390900e-02, -2.42156535387039185e-02, 4.22784924507141113e-01, -1.20418302714824677e-01, 1.63813799619674683e-01};
double fc1_biases[32*1] = {
    5.36179661750793457e-01, 
    3.36436241865158081e-01, 
    2.32372805476188660e-01, 
    -4.85383421182632446e-02, 
    8.25820397585630417e-03, 
    4.56991255283355713e-01, 
    -5.38378097116947174e-02, 
    5.16649603843688965e-01, 
    3.60917985439300537e-01, 
    2.56614327430725098e-01, 
    -5.39367273449897766e-02, 
    2.59290158748626709e-01, 
    -1.20182961225509644e-01, 
    8.68026614189147949e-02, 
    3.14824342727661133e-01, 
    -6.00091880187392235e-03, 
    -1.64150580763816833e-01, 
    -8.99709314107894897e-02, 
    -1.03905389551073313e-03, 
    -1.00468087475746870e-03, 
    5.72166264057159424e-01, 
    -1.32565602660179138e-01, 
    3.45883250236511230e-01, 
    3.57785999774932861e-01, 
    -7.03349336981773376e-02, 
    -1.43932223320007324e-01, 
    6.06450557708740234e-01, 
    2.48770579695701599e-01, 
    3.63615304231643677e-01, 
    3.13408732414245605e-01, 
    -5.84457851946353912e-02, 
    2.52566128969192505e-01};
double fc2_weights[32*32] = {
    3.45407485961914062e-01, -5.47035075724124908e-02, -2.48207166790962219e-01, 1.48444408550858498e-02, 2.53876745700836182e-01, -4.62693311274051666e-02, -2.89336323738098145e-01, 7.29971081018447876e-02, -5.64749501645565033e-02, -1.44066199660301208e-01, 4.05171334743499756e-01, -4.58544455468654633e-02, 7.67235457897186279e-02, 1.51772007346153259e-01, 9.14584472775459290e-03, 2.35813707113265991e-02, -2.94228136539459229e-01, -4.33507055044174194e-01, -3.68180498480796814e-02, -2.32493638992309570e-01, 3.82204025983810425e-01, -2.41248775273561478e-02, -6.25842139124870300e-02, -4.93211299180984497e-02, 1.13525018095970154e-02, -2.34567627310752869e-01, -1.79843755904585123e-03, 1.50704100728034973e-01, -5.13781048357486725e-02, 3.04378382861614227e-03, 1.00687511265277863e-01, -1.67320549488067627e-01, 
    -8.02775099873542786e-02, 9.26013290882110596e-02, -1.40671981498599052e-02, 6.52978345751762390e-02, -2.05678790807723999e-02, 9.67865586280822754e-02, 1.92847251892089844e-01, -3.22618782520294189e-01, 5.59822171926498413e-02, -2.32941494323313236e-03, -5.02963364124298096e-02, 3.80717106163501740e-02, 9.74206030368804932e-02, 6.02087490260601044e-02, 9.35914367437362671e-02, -9.85279120504856110e-03, -2.53636483103036880e-02, 5.02124093472957611e-02, 1.21808834373950958e-02, 1.47319957613945007e-02, 2.51965582370758057e-01, -2.69951876252889633e-02, 6.46120309829711914e-02, 5.46425059437751770e-02, -8.11823084950447083e-02, -3.54657135903835297e-02, 3.11810262501239777e-02, -2.86353342235088348e-02, 4.96018528938293457e-02, 1.29958977922797203e-02, 5.90133992955088615e-03, 2.15524926781654358e-01, 
    2.23874717950820923e-01, 1.08228191733360291e-01, -2.33401264995336533e-02, 5.00665940344333649e-02, -7.20973461866378784e-02, 2.27616444230079651e-01, 5.63852749764919281e-02, -1.20330592617392540e-02, 1.28108650445938110e-01, 1.60842597484588623e-01, 3.37701961398124695e-02, 9.05873924493789673e-02, -3.79746295511722565e-02, 6.22770795598626137e-03, 9.79694724082946777e-02, -4.85009886324405670e-03, 1.16045080125331879e-01, 1.81849300861358643e-02, -2.83673167228698730e-01, -7.77189359068870544e-02, 3.66763472557067871e-01, 1.94282129406929016e-01, 1.72093406319618225e-01, 1.17225967347621918e-01, -1.40217825770378113e-01, 1.16695389151573181e-01, 1.90044373273849487e-01, 1.09915174543857574e-01, 1.28297284245491028e-01, 1.11448287963867188e-01, 9.57615301012992859e-02, 2.46259286999702454e-01, 
    2.76654750108718872e-01, 9.91237163543701172e-02, 1.25668719410896301e-01, 2.06477828323841095e-02, -9.27723050117492676e-02, 1.21149323880672455e-01, 1.61216477863490582e-03, 2.11311146616935730e-01, 1.09477229416370392e-01, 6.35964721441268921e-02, 4.75609861314296722e-03, 8.15834701061248779e-02, -1.30180213600397110e-02, 4.01152558624744415e-02, 9.94583889842033386e-02, 9.06467512249946594e-02, -1.06194555759429932e-01, 4.73122149705886841e-02, -3.34070660173892975e-02, -7.02849999070167542e-02, 6.30277544260025024e-02, 2.60952990502119064e-02, 1.29581853747367859e-01, 9.41085144877433777e-02, -1.03826802223920822e-02, -1.43569290637969971e-01, 2.20146894454956055e-01, 1.95667102932929993e-01, 1.06193542480468750e-01, 1.65114954113960266e-01, -1.03448890149593353e-01, -4.81125079095363617e-02, 
    -1.53504312038421631e-01, -9.87259577959775925e-03, 1.83163762092590332e-01, 1.53131589293479919e-01, -1.36391744017601013e-01, 1.99651163657055264e-11, 1.01971410214900970e-01, 2.44039759039878845e-01, -4.93789552858779039e-41, 1.04411114007234573e-02, -3.96749787032604218e-02, -4.92220098578735244e-41, 2.35105782747268677e-01, 4.90734722206550938e-41, 2.49842676566913724e-04, 1.28471646457910538e-02, -2.31002599000930786e-01, -1.33282910041998548e-07, -1.90191358327865601e-01, -1.48467302322387695e-01, 1.94368466734886169e-01, 3.62540423870086670e-01, -2.89856605231761932e-02, 8.42116121202707291e-03, 3.32608133554458618e-01, -6.08621910214424133e-03, -1.07914254069328308e-01, -5.65288327634334564e-02, 1.16778677329421043e-03, -2.09183690458303317e-06, 1.15236811339855194e-01, -1.25334531068801880e-01, 
    -1.89044475555419922e-02, 6.12989924848079681e-02, -1.92923873662948608e-01, -2.73732125759124756e-01, -1.67970478534698486e-01, 2.40974929183721542e-02, 1.62819966673851013e-01, 3.01936715841293335e-01, 1.56711954623460770e-02, 2.59416997432708740e-01, -9.59900096058845520e-02, 1.25256087630987167e-02, 1.52307227253913879e-01, 3.62860739231109619e-01, 4.63127464056015015e-01, 6.73084333539009094e-02, -9.94209423661231995e-02, 2.44398951530456543e-01, 1.41824051737785339e-01, 1.75065219402313232e-01, 3.59063893556594849e-02, -4.79969412088394165e-01, -2.13390916585922241e-01, 3.15705053508281708e-02, -3.66232782602310181e-01, 6.48299753665924072e-02, 7.81236812472343445e-02, 3.46875518560409546e-01, 1.82093717157840729e-02, 1.19098067283630371e-01, 7.72011354565620422e-02, -2.56667166948318481e-01, 
    2.68156137317419052e-02, 4.94392178952693939e-02, 2.64431256800889969e-02, -1.21778035536408424e-02, -1.60215329378843307e-02, 5.50345778465270996e-02, 1.80417504161596298e-02, 1.55166850890964270e-03, 2.83739827573299408e-02, -3.07736266404390335e-02, 2.02130004763603210e-02, 2.27824393659830093e-02, -1.11798077821731567e-01, 1.13516695797443390e-01, 2.66067963093519211e-02, 3.10663953423500061e-02, -5.41832204908132553e-03, 1.19076378643512726e-01, 9.17671155184507370e-03, -2.91208624839782715e-02, 1.20563887059688568e-01, -3.38997840881347656e-02, 1.33121246472001076e-02, 1.86329707503318787e-02, -6.79052993655204773e-02, 8.29882826656103134e-03, 3.12077254056930542e-02, 1.68672588188201189e-04, 2.73299012333154678e-02, 2.42015551775693893e-02, -9.68635007739067078e-02, 8.30751806497573853e-02, 
    -1.70701801776885986e-01, -2.91023328900337219e-02, -3.30606400966644287e-02, -4.51503992080688477e-02, 1.89447950106114149e-03, 1.28208780661225319e-02, 2.91531324386596680e-01, -2.85224784165620804e-02, 1.12975668162107468e-02, 1.79725542664527893e-01, -1.17510423064231873e-01, 7.54058733582496643e-03, 8.68258550763130188e-02, 9.14143770933151245e-02, 1.78498372435569763e-01, -6.44312575459480286e-02, 3.95476929843425751e-02, 1.32081747055053711e-01, 5.49404621124267578e-02, 1.00626818835735321e-01, 1.96020305156707764e-01, -1.32298454642295837e-01, 3.05283907800912857e-02, 1.56962461769580841e-02, -1.02057404816150665e-01, 1.34016409516334534e-01, 9.29640457034111023e-02, 1.04811437427997589e-01, 1.12782027572393417e-02, 6.41071498394012451e-02, -2.16266456991434097e-02, 1.30563778802752495e-02, 
    -7.56744146347045898e-02, 6.55501857399940491e-02, 4.35502640902996063e-02, -2.54010837525129318e-02, 9.92066785693168640e-02, 1.05655349791049957e-01, 6.77595734596252441e-02, 3.40590579435229301e-03, 7.53662213683128357e-02, 7.54626691341400146e-02, 1.10980300232768059e-02, 5.68750016391277313e-02, -4.90902878022269916e-41, 1.62436977028846741e-01, 5.92576339840888977e-02, 1.10244546085596085e-02, -4.35058400034904480e-02, 1.09482325613498688e-01, -7.18779489398002625e-02, -1.11853510141372681e-01, 1.92409008741378784e-01, -1.93309709429740906e-02, 8.38659182190895081e-02, 7.06246197223663330e-02, -4.78295056382194161e-04, 4.77189384400844574e-02, -1.86338089406490326e-02, -7.29769235476851463e-03, 7.82305225729942322e-02, 3.56971696019172668e-02, -1.28987908363342285e-01, -8.25962871313095093e-02, 
    9.57554280757904053e-02, 1.47507861256599426e-02, 2.80951354652643204e-02, 1.32061600685119629e-01, -1.57126963138580322e-01, 2.82244756817817688e-02, -4.46587800979614258e-04, 3.40738482773303986e-02, 1.97628922760486603e-02, 1.51091180741786957e-02, -3.60198132693767548e-02, 1.51861142367124557e-02, 7.90550746023654938e-03, -5.20899286493659019e-03, 1.80629082024097443e-02, 6.22112080454826355e-02, 1.08341366052627563e-01, -6.50669198876130395e-06, -1.79284140467643738e-01, -7.14666619896888733e-02, 2.39918008446693420e-01, -2.76819826103746891e-03, 6.79678693413734436e-02, 2.21421439200639725e-02, 5.33591303974390030e-03, 4.01615910232067108e-02, 1.00988866761326790e-02, 2.82723996788263321e-02, 2.00922898948192596e-02, 1.80415362119674683e-02, -1.67679294943809509e-01, 1.33587479591369629e-01, 
    -2.20480233430862427e-01, -2.06017065793275833e-02, 5.00109408932883964e-41, -1.64550676941871643e-01, 4.40299585461616516e-02, -2.12342920713126659e-03, 1.67994454503059387e-01, -4.17194068431854248e-01, 4.90930903991556413e-41, -1.44533619284629822e-01, 2.09369376301765442e-01, -4.98610019576056410e-41, -9.75231267511844635e-03, 5.29680103063583374e-02, 2.76900846511125565e-02, -2.08145249634981155e-02, 3.36578600108623505e-02, 3.81606906652450562e-01, 2.18557746848091483e-04, 3.22384126484394073e-02, -1.41368359327316284e-01, -1.87831938266754150e-01, -2.44862623512744904e-02, -2.84643634222447872e-03, -7.47657790780067444e-02, 3.68853181600570679e-01, -3.06364625692367554e-01, -1.55268669128417969e-01, -1.01333353086374700e-04, 2.60613132268190384e-02, -4.08896170556545258e-02, 2.66369789838790894e-01, 
    3.96809309720993042e-01, 9.63458567857742310e-02, 2.03862264752388000e-01, -5.77352046966552734e-01, 2.28259846568107605e-01, 1.20513759553432465e-01, -4.82503121020272374e-04, 2.57950901985168457e-01, 6.89005553722381592e-02, 1.09534978866577148e-01, 4.50708065181970596e-03, 4.91296388208866119e-02, 8.61320570111274719e-02, -5.66464886069297791e-02, 9.22313928604125977e-02, -6.58764913678169250e-02, -2.79154390096664429e-01, 3.03808413445949554e-02, -2.39123582839965820e-01, -2.58282601833343506e-01, -2.22781553864479065e-01, 4.47820778936147690e-03, 3.38777974247932434e-02, 7.21956416964530945e-02, 3.78602117300033569e-01, -6.45477371290326118e-03, 5.20137548446655273e-01, 3.25501590967178345e-01, 7.03396946191787720e-02, 5.48017211258411407e-02, 6.24054595828056335e-02, -2.84345060586929321e-01, 
    3.08459550142288208e-01, -7.93203827925026417e-04, 4.59956377744674683e-02, -6.90845921635627747e-02, 2.74492595344781876e-02, 3.44960689544677734e-02, -1.13701373338699341e-01, 7.25364163517951965e-02, 7.83132296055555344e-03, -1.35923877358436584e-01, 1.51841808110475540e-03, 6.88177114352583885e-03, 2.71237462759017944e-01, -2.17617228627204895e-01, -5.05205690860748291e-01, -1.81295722723007202e-01, 2.20267727971076965e-01, 4.02721524238586426e-01, -2.00846865773200989e-01, -1.20529226958751678e-01, 2.13675573468208313e-01, -5.44289201498031616e-02, -4.44031208753585815e-02, 1.00895371288061142e-02, 2.53259211778640747e-01, 6.78324773907661438e-02, -5.68026229739189148e-02, 3.37378121912479401e-02, 1.11474776640534401e-02, -1.24190904200077057e-01, 1.38592585921287537e-01, 2.38335818052291870e-01, 
    5.03920204937458038e-02, 6.25236332416534424e-02, -3.81424813531339169e-03, 2.88253966718912125e-02, 1.44839718937873840e-01, 3.58579978346824646e-02, 1.17176130414009094e-01, 3.22864018380641937e-02, 2.67860237509012222e-02, -4.18181084096431732e-02, 1.73674836754798889e-01, 1.61789245903491974e-02, -9.63155925273895264e-02, -4.53173369169235229e-02, 6.72631859779357910e-02, -3.60936187207698822e-02, -3.90212535858154297e-02, -4.93702851235866547e-03, -2.91610546410083771e-02, -1.52012696489691734e-02, 1.30430445075035095e-01, 4.41235527396202087e-02, 2.92777232825756073e-02, 3.78219187259674072e-02, -4.56217117607593536e-02, 9.34994406998157501e-03, -8.66394564509391785e-02, 5.47789782285690308e-03, 2.55662780255079269e-02, 6.93568959832191467e-02, 1.09310075640678406e-02, -2.20707152038812637e-03, 
    1.51203721761703491e-01, -1.51756498962640762e-02, 1.43250077962875366e-01, 5.35123795270919800e-02, 2.10917934775352478e-01, -6.44969716668128967e-02, -2.64562606811523438e-01, 4.41490225493907928e-02, -3.66999320685863495e-02, -1.25471614301204681e-02, -3.62936109304428101e-02, -2.74790357798337936e-02, 1.45590245723724365e-01, 5.71361407637596130e-02, -5.80484159290790558e-02, 3.82030569016933441e-02, -6.57443553209304810e-02, -1.18508301675319672e-01, -2.22480073571205139e-01, -1.69196918606758118e-01, 3.85189741849899292e-01, 1.41065314412117004e-01, -8.51629003882408142e-02, -3.28862443566322327e-02, 1.76502555608749390e-01, -1.05199567973613739e-01, 1.59120172262191772e-01, 5.02634942531585693e-02, -3.47375795245170593e-02, -3.63951064646244049e-02, -8.58005955815315247e-02, -5.47713786363601685e-02, 
    2.95247524976730347e-01, 3.98994833230972290e-02, 3.50334532558917999e-02, 4.33670841157436371e-02, -2.32939124107360840e-02, 1.77863892167806625e-02, -8.74227436725050211e-04, 1.25600710511207581e-01, 1.93027593195438385e-02, 1.21029756963253021e-01, 3.20072546601295471e-02, 1.58241055905818939e-02, -6.82456120848655701e-02, 9.09327641129493713e-02, -2.99429353326559067e-02, 9.27912667393684387e-02, -8.40612798929214478e-02, -2.90922485291957855e-02, 5.42513690888881683e-02, -4.79497648775577545e-02, -5.10419942438602448e-02, 1.52210975065827370e-02, 8.74089077115058899e-03, 1.98665093630552292e-02, 5.73338121175765991e-02, 1.39581700786948204e-02, 4.50215972959995270e-02, 1.19936717674136162e-02, 1.92598383873701096e-02, 1.39456018805503845e-01, -7.58496075868606567e-02, 7.93815776705741882e-02, 
    2.24857106804847717e-01, 4.41680960357189178e-02, 3.29138971865177155e-02, 6.26243799924850464e-02, -2.27822959423065186e-02, 1.43145784735679626e-01, -8.60914494842290878e-03, 1.65149778127670288e-01, 1.01475223898887634e-01, 1.03863045573234558e-01, 5.93138374388217926e-02, 7.29165822267532349e-02, -5.84789700806140900e-02, 6.60821935161948204e-03, 6.87071084976196289e-02, 8.96239466965198517e-03, 2.04808078706264496e-02, 7.82357342541217804e-03, 1.78499985486268997e-02, -2.02792927622795105e-01, 1.79281011223793030e-01, 4.94190417230129242e-02, 8.29161107540130615e-02, 9.74270254373550415e-02, 2.53124181181192398e-02, 3.04537620395421982e-02, 1.29389330744743347e-01, 6.72712847590446472e-02, 9.59842801094055176e-02, 1.24977819621562958e-01, 4.96894270181655884e-02, 1.51453584432601929e-01, 
    -4.83175128698348999e-01, -1.64439585059881210e-02, 4.70163896679878235e-02, -2.54058420658111572e-01, 6.16258718073368073e-02, 1.07141758780926466e-03, 3.87932062149047852e-01, -2.07865595817565918e-01, -4.95681305785617542e-41, 7.19035416841506958e-02, 2.18421295285224915e-01, 5.04285278356571919e-41, 1.64365604519844055e-01, -2.00292229652404785e-01, 2.46602809056639671e-04, -1.31923034787178040e-01, 2.88684070110321045e-01, 9.74555686116218567e-03, -5.55011890828609467e-02, 1.32835684344172478e-02, -1.35978832840919495e-01, -7.64806568622589111e-01, 8.71182046830654144e-03, 1.08664517756551504e-03, -8.01620557904243469e-02, 3.38607102632522583e-01, -2.24756091833114624e-01, 2.13900148868560791e-01, -7.51591915104654618e-06, -8.11850130558013916e-02, 2.26251900196075439e-01, 5.02387359738349915e-02, 
    -6.76347687840461731e-03, -5.91215956956148148e-03, 2.72966101765632629e-02, 2.73277282714843750e-01, -5.24985969066619873e-01, 4.91197150699778128e-41, 1.18883728981018066e-01, -3.85647982358932495e-01, -4.90776761160480683e-41, 2.15995296835899353e-01, -1.75016745924949646e-02, 4.95204864307747105e-41, 4.94302272796630859e-01, -1.84006318449974060e-02, 8.92805214971303940e-03, -1.04668345302343369e-02, 1.85043081641197205e-01, 1.12703973427414894e-02, -3.22614192962646484e-01, -1.41074210405349731e-01, -1.56671538949012756e-01, 4.32120710611343384e-01, 2.33020205050706863e-02, -3.08598522096872330e-02, -2.74977963417768478e-02, 9.33276712894439697e-02, -1.05091296136379242e-01, -7.43950903415679932e-02, 3.89319902751594782e-04, -1.48586546712403678e-12, -1.61515157669782639e-02, 1.29537776112556458e-01, 
    -1.11483752727508545e-01, -5.22478716447949409e-03, 4.80844825506210327e-02, 2.19621792435646057e-01, -1.72574356198310852e-01, 4.90958929960842909e-41, 1.60507917404174805e-01, -4.08102661371231079e-01, 5.04257252387285423e-41, 2.69641596823930740e-02, 4.89820167422294617e-02, -4.94153890459503492e-41, 1.84970021247863770e-01, 1.15625683974940330e-04, -1.87378190457820892e-02, 1.54991909861564636e-01, -1.08023293316364288e-01, 5.29332123696804047e-02, 9.70536544919013977e-02, -4.79634739458560944e-02, 3.36315557360649109e-02, 5.06916956510394812e-04, 5.90393580496311188e-02, 1.88624765723943710e-03, -1.19666762650012970e-01, 4.06128615140914917e-02, -4.55850213766098022e-02, -1.77848450839519501e-02, 6.86318162479437888e-05, 1.50694381445646286e-02, 2.09623858332633972e-01, 1.33439436554908752e-01, 
    1.15947358310222626e-01, 1.53031041845679283e-02, 6.81029632687568665e-02, -3.30590046942234039e-02, 5.38734048604965210e-02, -7.88939520716667175e-02, 9.84695833176374435e-03, 1.85952354222536087e-02, -6.19473084807395935e-02, 1.89256910234689713e-02, 5.20574674010276794e-02, -4.90296408534049988e-02, 6.23467527329921722e-02, 8.06133300065994263e-02, -1.48367723450064659e-02, -1.18040041998028755e-02, -7.23876710981130600e-03, 2.08197571337223053e-02, -4.49170507490634918e-02, -3.29721532762050629e-02, 2.26098358631134033e-01, 8.37236549705266953e-03, 1.83758959174156189e-02, -4.49438132345676422e-02, 5.03739938139915466e-02, 4.53465804457664490e-02, 8.89131054282188416e-02, 1.14578500390052795e-01, -5.20457848906517029e-02, -1.59638524055480957e-02, 1.00437989458441734e-02, -1.75058152526617050e-02, 
    3.38601469993591309e-01, -5.80228082835674286e-02, 5.66303990781307220e-02, -1.52055785059928894e-01, -4.11239638924598694e-02, 1.76550615578889847e-02, -1.20921246707439423e-01, 1.71853631734848022e-01, 1.46417245268821716e-02, 8.73441919684410095e-02, -3.64745333790779114e-02, 1.24774407595396042e-02, 1.35750807821750641e-02, 7.02711716294288635e-02, -5.99907431751489639e-03, 4.54841703176498413e-02, -6.54996633529663086e-02, 5.25157386437058449e-03, -5.36086270585656166e-03, -1.72298625111579895e-02, 5.65355606377124786e-02, -1.33060187101364136e-01, -8.22868011891841888e-03, 1.93297155201435089e-02, 2.89458059705793858e-03, -1.05664044618606567e-01, 1.21773771941661835e-01, 9.85552296042442322e-02, 1.47873098030686378e-02, -1.63470059633255005e-02, -1.27102226018905640e-01, 2.62990221381187439e-03, 
    4.14952822029590607e-02, 6.00827746093273163e-02, 2.74734944105148315e-01, -1.43497481942176819e-01, 1.41845151782035828e-01, 8.16170778125524521e-03, 2.22632326185703278e-02, 1.29686757922172546e-01, 4.88699972629547119e-03, -1.73687990754842758e-02, -1.52776628732681274e-01, 5.10332547128200531e-03, -2.09036320447921753e-01, 6.10219985246658325e-02, 1.71561524271965027e-01, -1.69959306716918945e-01, -1.83504134416580200e-01, 3.20670083165168762e-02, 5.71170598268508911e-02, 2.69627720117568970e-01, -4.03452478349208832e-02, -1.03299744427204132e-01, 6.20844680815935135e-03, 3.00908200442790985e-02, -1.70402050018310547e-01, -1.68524295091629028e-01, 2.22546011209487915e-01, 2.10371822118759155e-01, 8.61078407615423203e-03, 1.14012524485588074e-01, 2.40345954895019531e-01, -1.57211706042289734e-01, 
    5.08322417736053467e-02, 5.09111173450946808e-02, -3.65590229630470276e-02, -1.11967436969280243e-01, 4.02093566954135895e-02, 1.24205023050308228e-01, 3.04591834545135498e-01, 1.23822860419750214e-01, 7.50053077936172485e-02, 2.08670184016227722e-01, 2.08127070218324661e-02, 5.41381724178791046e-02, 9.03152525424957275e-02, 2.12956488132476807e-01, 1.62930861115455627e-01, -1.27136126160621643e-01, 1.41053516417741776e-02, 2.61496245861053467e-01, -1.20357356965541840e-01, -6.93511888384819031e-02, 2.32606902718544006e-01, -1.31927058100700378e-01, 4.64625544846057892e-02, 7.92524144053459167e-02, -1.25935584306716919e-01, 1.50307625532150269e-01, 1.60862997174263000e-01, -1.90009754151105881e-02, 6.64307177066802979e-02, 9.14646461606025696e-02, 1.03590376675128937e-02, 1.73399209976196289e-01, 
    1.84019193053245544e-01, 1.01364925503730774e-01, 9.60525199770927429e-02, -3.34246805869042873e-03, -3.19540761411190033e-02, 1.98618501424789429e-01, 4.68116886913776398e-02, 1.51670381426811218e-01, 1.10259518027305603e-01, 3.77495139837265015e-02, 3.52275930345058441e-02, 7.58808106184005737e-02, -8.49053412675857544e-02, 1.96041725575923920e-02, 1.78421065211296082e-01, -5.52898682653903961e-02, -3.33822704851627350e-03, 3.01036201417446136e-02, -6.86770081520080566e-02, -8.55955109000205994e-02, 2.27237820625305176e-01, 2.52960305660963058e-02, 1.14361263811588287e-01, 9.58096086978912354e-02, -3.32724372856318951e-03, 1.56232118606567383e-02, 1.82611688971519470e-01, -4.54675517976284027e-02, 1.04021944105625153e-01, 1.87128677964210510e-01, 1.75220146775245667e-03, 1.02345302700996399e-01, 
    1.46330639719963074e-01, 8.82693827152252197e-02, 7.70211592316627502e-02, -1.50797199457883835e-02, -4.15575355291366577e-02, 1.36805728077888489e-01, 3.16638313233852386e-03, 5.70356138050556183e-02, 8.26191082596778870e-02, -2.50183910131454468e-01, 1.22444309294223785e-01, 5.79714812338352203e-02, -2.51823272556066513e-02, 1.32109791040420532e-01, 1.13280519843101501e-01, 5.82646690309047699e-02, 3.69427166879177094e-02, 8.74479040503501892e-02, 2.81745772808790207e-02, -8.68527218699455261e-02, 4.51462894678115845e-01, 7.39440396428108215e-02, 1.28043517470359802e-01, 8.16003754734992981e-02, 1.71883665025234222e-02, 3.17640528082847595e-02, 2.81867682933807373e-01, 1.57635077834129333e-01, 7.19259679317474365e-02, 1.29992663860321045e-01, 3.80392670631408691e-02, 5.49982935190200806e-02, 
    -1.68100014328956604e-01, 1.66449379175901413e-02, 9.03481338173151016e-03, 1.37922968715429306e-02, 1.39858387410640717e-02, -4.91939838885870281e-41, 8.34498107433319092e-02, 2.01137159019708633e-02, -4.97096617234585608e-41, -1.52021355461329222e-03, 8.94873887300491333e-02, -4.96339916063850207e-41, -3.83095443248748779e-01, 1.02181024849414825e-01, 6.55367225408554077e-02, -3.80799710750579834e-01, 2.08944138139486313e-02, 1.82310670614242554e-01, -2.20783557742834091e-02, 1.64297502487897873e-02, -4.40334439277648926e-01, -8.42416584491729736e-02, -4.91645566208362069e-41, -2.72695487365126610e-03, 1.92598663270473480e-02, 1.93956375122070312e-01, 4.06809290871024132e-03, 1.00199639797210693e-01, 3.62210339517332613e-05, 1.66124978568404913e-03, -2.04650759696960449e-02, 3.73755276203155518e-01, 
    2.55344241857528687e-01, 1.10060609877109528e-01, 3.37621085345745087e-02, -5.58960065245628357e-03, -1.42892390489578247e-01, 1.30363062024116516e-01, 7.15617388486862183e-02, 1.12461082637310028e-01, 9.89213585853576660e-02, 1.32149100303649902e-01, 9.83946472406387329e-02, 7.33566880226135254e-02, 1.70937757939100266e-02, 3.10338679701089859e-02, 1.34240150451660156e-01, 3.37177589535713196e-02, -1.35923907160758972e-01, -1.48609932512044907e-02, -2.73562520742416382e-02, -1.38416171073913574e-01, 1.61448046565055847e-01, -7.13818520307540894e-03, 1.04186519980430603e-01, 1.00069463253021240e-01, -2.36322637647390366e-02, 1.62563193589448929e-02, 2.47318193316459656e-01, 1.13124199211597443e-01, 1.06960579752922058e-01, 3.15206408500671387e-01, -1.19776256382465363e-01, 9.58160031586885452e-03, 
    8.94772931933403015e-02, 9.28401425480842590e-02, -7.68128335475921631e-02, 3.55850569903850555e-02, 7.06216469407081604e-02, -4.97193029150366783e-03, 3.26766550540924072e-01, 1.10424989834427834e-02, 1.90137941390275955e-02, 3.42222526669502258e-02, 8.33861827850341797e-02, 1.74605716019868851e-02, 6.39400929212570190e-02, 1.14837132394313812e-01, 6.88593268394470215e-01, -4.89418894052505493e-01, 1.12067279405891895e-03, 1.94871872663497925e-01, -6.19966164231300354e-02, 1.50217572227120399e-02, 2.05443710088729858e-01, -1.65405660867691040e-01, 1.87628343701362610e-02, 3.30896750092506409e-02, -1.14994779229164124e-01, 1.66255652904510498e-01, 2.14126482605934143e-01, 2.92740184813737869e-02, 2.40055266767740250e-02, 2.23901376128196716e-01, -2.56383474916219711e-02, -1.58776149153709412e-01, 
    1.68044254183769226e-01, 2.66400240361690521e-02, -8.53912979364395142e-02, 1.73686653375625610e-01, 1.59165915101766586e-02, -6.97630271315574646e-02, -2.15288773179054260e-02, -2.16549664735794067e-01, -4.43803668022155762e-02, 1.20262220501899719e-01, 1.77244350314140320e-01, -3.87180186808109283e-02, 6.14892970770597458e-03, -9.85033661127090454e-02, 1.62041053175926208e-01, -8.72174650430679321e-02, 6.79637491703033447e-02, -2.27730292826890945e-02, 1.01231530308723450e-01, -2.17777475714683533e-01, 3.00237506628036499e-01, 5.57951033115386963e-02, -7.04733356833457947e-02, -3.60544212162494659e-02, -1.74815878272056580e-01, 7.00169801712036133e-02, 1.16284884512424469e-01, -2.69105639308691025e-02, -3.43114770948886871e-02, 1.86715438961982727e-01, 2.26462438702583313e-01, 3.09200465679168701e-01, 
    2.82371733337640762e-02, -1.69559810310602188e-02, 7.97471329569816589e-02, 7.25530311465263367e-02, -3.13206836581230164e-02, -1.69713161885738373e-02, -6.09345175325870514e-03, 5.54486364126205444e-02, -7.33574992045760155e-03, -1.86628904193639755e-02, 1.34622901678085327e-01, -3.49263730458915234e-03, 2.51916740089654922e-02, 7.52201629802584648e-03, 4.56918543204665184e-03, 1.06271311640739441e-01, -1.87236703932285309e-02, 6.57259486615657806e-04, 5.47783151268959045e-02, -1.69595524668693542e-01, 6.53903931379318237e-02, 8.35741460323333740e-02, 6.92185983061790466e-02, -9.61442571133375168e-03, -8.35855454206466675e-02, -3.33140492439270020e-02, -2.91598755866289139e-02, 3.03829703480005264e-02, -7.19997752457857132e-03, 7.47746089473366737e-03, -1.60810738801956177e-01, 2.75132507085800171e-02, 
    -4.01404350996017456e-02, -3.73380854725837708e-02, 2.37101793289184570e-01, -1.84180945158004761e-01, -2.69484966993331909e-01, 6.84909000992774963e-02, -1.85820251703262329e-01, 2.32669785618782043e-01, 5.66098690032958984e-02, -1.25437974929809570e-01, 1.50031358003616333e-01, 4.25407588481903076e-02, 9.76952724158763885e-03, 2.59872023016214371e-02, 8.96888747811317444e-02, 1.63074702024459839e-01, -1.02378167212009430e-01, -6.16991566494107246e-03, 1.88095390796661377e-01, -1.55055478215217590e-01, -7.96073898673057556e-02, -3.43740284442901611e-02, 1.19171902537345886e-01, 4.36997264623641968e-02, -5.53285749629139900e-03, -8.87104272842407227e-02, 1.30943998694419861e-01, -3.26913222670555115e-02, 4.92518208920955658e-02, 1.09383039176464081e-01, -1.10630467534065247e-01, -5.01813329756259918e-02};
double fc2_biases[32*1] = {
    -1.52396440505981445e-01, 
    2.24335446953773499e-01, 
    3.41805875301361084e-01, 
    3.12471956014633179e-01, 
    -1.35960847139358521e-01, 
    1.57592117786407471e-01, 
    1.07327200472354889e-01, 
    1.70532271265983582e-01, 
    1.86357751488685608e-01, 
    4.76443767547607422e-02, 
    -1.70238628983497620e-01, 
    3.47794741392135620e-01, 
    1.40223316848278046e-02, 
    1.62943050265312195e-01, 
    -1.53967380523681641e-01, 
    3.18403691053390503e-02, 
    2.70911663770675659e-01, 
    -8.55940878391265869e-02, 
    -1.19769766926765442e-01, 
    -1.31134986877441406e-01, 
    -4.61121797561645508e-02, 
    8.27140882611274719e-02, 
    2.44454607367515564e-01, 
    2.53474771976470947e-01, 
    3.21710824966430664e-01, 
    4.09491449594497681e-01, 
    -5.95387257635593414e-02, 
    3.00932168960571289e-01, 
    7.55544230341911316e-02, 
    -1.26113653182983398e-01, 
    -6.59253597259521484e-02, 
    2.86498069763183594e-01};
double fc3_weights[10*32] = {
    4.96311157941818237e-01, -4.46699038147926331e-02, -5.91067736968398094e-03, -1.19764029979705811e-01, 1.56578928232192993e-01, 5.34133791923522949e-01, -1.17949925363063812e-01, 3.28118264675140381e-01, 1.00057102739810944e-01, -1.31140435114502907e-02, -5.07395029067993164e-01, -4.55497205257415771e-01, -5.03056108951568604e-01, 1.76143392920494080e-01, 2.48353034257888794e-01, -1.79124414920806885e-01, -9.98503491282463074e-02, 8.93515050411224365e-02, -8.94106272608041763e-03, -1.14072278141975403e-01, 9.78704690933227539e-02, 3.31254266202449799e-02, 4.10855531692504883e-01, 5.49025312066078186e-02, 6.22769743204116821e-02, 2.05659732222557068e-01, -5.97319304943084717e-01, -2.50957965850830078e-01, 7.22381174564361572e-01, 1.83508649468421936e-01, -2.34424974769353867e-02, -2.16469336301088333e-02, 
    -3.25280696153640747e-01, 3.57086211442947388e-01, 5.35107851028442383e-01, 5.50516724586486816e-01, -2.38414928317070007e-01, 2.43555381894111633e-01, 1.80564671754837036e-01, 1.68093532323837280e-01, 3.28908532857894897e-01, 1.51328966021537781e-01, 2.84852743148803711e-01, 4.85354661941528320e-01, 2.16860413551330566e-01, 1.85388222336769104e-01, -1.14657916128635406e-01, 3.43640930950641632e-02, 4.33029085397720337e-01, 4.16450738906860352e-01, -3.50880593061447144e-01, 1.06813579797744751e-01, -2.16432169079780579e-01, 8.87424871325492859e-02, 2.76712477207183838e-01, 3.20621281862258911e-01, 4.87429738044738770e-01, 4.63824301958084106e-01, 7.67169535160064697e-01, 5.51392018795013428e-01, 1.49330362677574158e-01, -1.43705680966377258e-01, -5.97675479948520660e-02, 4.17418420314788818e-01, 
    3.18759121000766754e-02, -7.20534622669219971e-02, -2.11250986903905869e-02, -2.02469751238822937e-01, -2.31678690761327744e-02, 1.82731330394744873e-01, 2.97456029802560806e-02, 2.69573986530303955e-01, -3.25631326995790005e-03, -6.69196131639182568e-04, 3.62733811140060425e-01, 3.29870700836181641e-01, 2.56194591522216797e-01, -1.25640511512756348e-01, 3.60026329755783081e-01, 9.62150767445564270e-02, 6.64393082261085510e-02, 1.88329681754112244e-01, 2.47701376676559448e-01, -1.09493769705295563e-01, -2.39966548979282379e-02, 3.14132660627365112e-01, 4.24814224243164062e-01, -1.85119181871414185e-01, -2.98448979854583740e-01, -1.54374763369560242e-01, -2.15777799487113953e-01, -5.40986983105540276e-03, 5.88148683309555054e-02, 2.23227351903915405e-01, -1.08215510845184326e-01, 2.51686573028564453e-01, 
    -2.05105287022888660e-03, 2.07798257470130920e-01, 6.68731937184929848e-03, 3.21426950395107269e-02, 2.54852939397096634e-02, 4.49882261455059052e-02, 4.91027161478996277e-02, 1.46989881992340088e-01, -6.32491149008274078e-03, -3.23508977890014648e-02, 5.94393573701381683e-02, 4.84085306525230408e-02, -1.36837661266326904e-01, -1.61260121967643499e-03, 5.31609617173671722e-02, -1.70197132974863052e-02, 1.18774861097335815e-01, 1.54405161738395691e-01, -5.55960386991500854e-02, 1.86078533530235291e-01, 1.39663629233837128e-02, -2.06732284277677536e-02, 4.65733669698238373e-02, 7.70638044923543930e-03, 6.00812546908855438e-02, 1.36238053441047668e-01, 2.63073551468551159e-03, 4.07584123313426971e-02, 2.05595102161169052e-02, 1.55536934733390808e-01, 1.59767627716064453e-01, 1.24156596139073372e-02, 
    1.80581167340278625e-01, 1.43591582775115967e-01, 5.67095540463924408e-03, -1.86616983264684677e-02, 3.29047650098800659e-01, 2.33393549919128418e-01, -2.53617744892835617e-02, -1.90116137266159058e-01, -6.78161308169364929e-02, 2.50321596860885620e-01, 3.58696281909942627e-02, 4.07271683216094971e-01, 1.87858611345291138e-01, 4.77879345417022705e-02, -1.60739645361900330e-02, 2.51007229089736938e-01, -1.63391023874282837e-01, 2.61801003944128752e-04, 2.86657601594924927e-01, 9.05555486679077148e-02, 8.73416289687156677e-02, 1.70266665518283844e-02, 3.55954825878143311e-01, -7.92210921645164490e-02, 7.80723765492439270e-02, 1.70227900147438049e-01, -5.94092421233654022e-02, 2.23966419696807861e-01, 4.11989092826843262e-01, 2.76159077882766724e-01, -1.14404797554016113e-01, -2.15860158205032349e-02, 
    -7.36505398526787758e-03, 1.47219412028789520e-02, 2.58711222559213638e-02, 6.53684437274932861e-02, 1.23825311660766602e-01, 3.69488634169101715e-02, 2.69124228507280350e-02, 9.08696427941322327e-02, 2.72870305925607681e-02, 2.55702864378690720e-02, 7.08183124661445618e-02, 6.18220791220664978e-02, 1.64347797632217407e-01, 5.78301493078470230e-03, 7.60048702359199524e-02, 1.31885990500450134e-01, 5.01910448074340820e-02, 7.59477959945797920e-03, 1.18633359670639038e-02, 8.40615928173065186e-02, 7.00418055057525635e-02, 7.28012472391128540e-02, 1.20749883353710175e-01, 6.40333965420722961e-02, 2.45239827781915665e-02, 1.30181849002838135e-01, 1.32588713313452899e-04, 4.11707200109958649e-02, 3.99903096258640289e-02, 1.42135962843894958e-01, 1.01139582693576813e-01, 1.69255584478378296e-01, 
    2.70320149138569832e-03, 2.17588664963841438e-03, 3.98758891969919205e-03, 2.16824701055884361e-03, 2.49728583730757236e-03, -7.32025923207402229e-03, 8.74767662025988102e-04, -6.13605836406350136e-03, -1.12449249718338251e-03, 1.20195816271007061e-03, -4.70566377043724060e-03, 4.06276760622859001e-03, 5.28343021869659424e-02, 1.34319709613919258e-02, 2.65070404857397079e-02, 3.08525785803794861e-02, -4.91759879514575005e-03, 3.21325077675282955e-03, 1.63666321896016598e-03, 2.90519036352634430e-02, 4.11961320787668228e-03, 1.04162096977233887e-03, 3.87288257479667664e-02, 2.64797825366258621e-03, 3.49734770134091377e-03, 3.62277254462242126e-02, -4.43348981207236648e-05, 3.38156381621956825e-03, 2.23605288192629814e-03, 4.69274027273058891e-03, -1.28537341952323914e-02, 2.81991029623895884e-04, 
    -3.49857355467975140e-03, 3.15020955167710781e-03, -2.76595726609230042e-02, 1.88011918216943741e-02, 3.41391414403915405e-01, 4.74812500178813934e-02, -4.57111001014709473e-03, 5.08486256003379822e-02, -9.34416835661977530e-04, -1.34029258042573929e-02, 9.42385476082563400e-03, 5.76049499213695526e-02, 2.12701767683029175e-01, -2.68418733030557632e-02, 3.75718474388122559e-02, 5.02589866518974304e-02, 5.76609820127487183e-02, -5.38122504949569702e-02, 4.70549575984477997e-02, 9.06978771090507507e-02, 9.25825312733650208e-02, 1.09078243374824524e-01, 7.05083906650543213e-02, 1.65742088574916124e-03, -1.78098101168870926e-02, 8.55123996734619141e-03, -4.09853309975005686e-05, 9.96796693652868271e-03, 8.08175560086965561e-03, -1.42622515559196472e-02, 1.03783369064331055e-01, 3.20501655340194702e-01, 
    -7.26607337128371000e-04, 1.72587767243385315e-01, 5.73597662150859833e-02, 3.64596843719482422e-02, -5.07564516738057137e-03, 1.57004758715629578e-01, -2.60007046163082123e-02, 1.14487335085868835e-01, 1.14898262545466423e-02, 2.57077626883983612e-02, 4.99709434807300568e-02, 3.83092910051345825e-02, -8.48658010363578796e-02, 8.84436164051294327e-03, 1.26058375462889671e-02, -9.61365294642746449e-04, 5.29504893347620964e-03, 7.47039243578910828e-02, 3.23492228984832764e-01, 1.48614808917045593e-01, 6.66849035769701004e-03, 3.33392689935863018e-03, 4.79495674371719360e-02, -6.79407315328717232e-03, 4.55864705145359039e-02, 2.07559749484062195e-01, 9.16477991268038750e-04, 3.83189208805561066e-02, 2.83288173377513885e-02, 1.36888369917869568e-01, 9.72571447491645813e-02, 3.83180677890777588e-02, 
    1.53753645718097687e-02, -2.24460307508707047e-02, -3.22407871484756470e-01, 1.19568663649260998e-03, 4.24928724765777588e-01, -3.82969439029693604e-01, 2.26512383669614792e-02, -2.29891762137413025e-02, 5.15965558588504791e-03, -8.61447304487228394e-02, 4.28600125014781952e-02, 7.30947852134704590e-02, 3.24284881353378296e-01, 2.22003348171710968e-02, 1.40105128288269043e-01, 3.44192124903202057e-02, -3.85450571775436401e-02, 2.16610580682754517e-01, 4.98919576406478882e-01, 3.54764461517333984e-01, 5.96072226762771606e-02, -2.18879487365484238e-02, -1.04052439332008362e-01, 4.39002970233559608e-03, -4.10763807594776154e-02, 2.86524500697851181e-02, -4.46311423729639500e-05, 1.03533279616385698e-03, 7.44493771344423294e-03, -9.60108824074268341e-03, 7.86611959338188171e-02, 4.34869676828384399e-02};
double fc3_biases[10*1] = {
    1.02082798257470131e-02, 
    3.78319501876831055e-01, 
    1.16419561207294464e-01, 
    7.56997689604759216e-02, 
    1.51147246360778809e-01, 
    8.26511457562446594e-02, 
    -8.72488785535097122e-03, 
    -2.51126904040575027e-02, 
    -4.75681275129318237e-02, 
    -3.95559847354888916e-01};


                        
// Fully connected layer 
void fullyConnectedLayer(double* inputNt, int input_size, double* outputNt, int output_size, double* weights, double* biases) {
    // Perform matrix multiplication and add bias
    for (int i = 0; i < output_size; i++) {
        outputNt[i] = 0;  // Initialize output to 0
        for (int j = 0; j < input_size; j++) {
            outputNt[i] += inputNt[j] * weights[i * input_size + j];  // Weight matrix multiplication
        }
        outputNt[i] += biases[i];  // Add bias
    }
}

// ReLU activation function
void relu(double* data, int size) {
    for (int i = 0; i < size; i++) {
        if (data[i] < 0) data[i] = 0;
    }
}

void forwardPass(double* input, double* output) {
    double fc1_output[32];
    double fc2_output[32];

    // Step 1: First fully connected layer + ReLU
    fullyConnectedLayer(input, 7, fc1_output, 32, fc1_weights, fc1_biases);
    relu(fc1_output, 32);
    // Step 2: Second fully connected layer + ReLU
    fullyConnectedLayer(fc1_output, 32, fc2_output, 32, fc2_weights, fc2_biases);
    relu(fc2_output, 32);
    // Step 3: Third fully connected layer + output
    fullyConnectedLayer(fc2_output, 32, output, 10, fc3_weights, fc3_biases);
}

// Choose an action based on the network's output
void chooseGreedyAction(double* input, int input_size, int& action_output) {
    double logits[10];
    double probabilities[10];

    forwardPass(input, logits);  // Get raw action scores (Q-values)
    softmax(logits, probabilities); 
    // Find the index (action) with the highest score
    int best_action = 0;
    double max_value = probabilities[0];
    Serial.print("P values : "); 
    for (int i = 0; i < 10; i++) {
       Serial.print(probabilities[i]);Serial.print("  ");
        if (probabilities[i] > max_value) {
            max_value = probabilities[i];
            best_action = i;
        }
    }
    Serial.print("Best action : ");  Serial.println(best_action);
    action_output = best_action;
    
}

void softmax(double* logits, double* probabilities) {
    double sum = 0;
    // Compute the exponentials and their sum
    for (int i = 0; i < 10; i++) {
        probabilities[i] = exp(logits[i]);  // Exponentiate each logit
        sum += probabilities[i];  // Sum of exponentials
    }
    // Normalize to get probabilities
    for (int i = 0; i < 10; i++) {
        probabilities[i] /= sum;  // Divide by sum to normalize
    }
}
